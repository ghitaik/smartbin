<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SmartBin ‚ôªÔ∏è</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      max-width: 700px;
      margin: 40px auto;
      padding: 0 15px;
    }
    h1 {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    h1 span {
      font-size: 1.5em;
    }
    input[type="file"], button {
      margin-top: 10px;
    }
    pre {
      background: #f6f6f6;
      padding: 10px;
      border-radius: 8px;
      overflow-x: auto;
    }
    #suggestion {
      margin-top: 15px;
      padding: 12px;
      background: #e8f5e9;
      border-left: 4px solid #4caf50;
      border-radius: 6px;
      display: none;
    }
  </style>
</head>
<body>
  <h1>SmartBin <span>‚ôªÔ∏è</span></h1>
  <p>Upload a photo and get the German bin suggestion.</p>

  <label for="api">API URL</label><br />
  <input id="api" type="text" value="https://smartbin-api-4ycp.onrender.com" style="width: 100%; padding: 6px;" />
  <button id="use">Use</button>

  <br /><br />
  <input type="file" id="file" accept="image/*" />
  <button id="predict">Predict</button>

  <div id="suggestion"></div>
  <pre id="out"></pre>

  <script>
    const btn = document.getElementById("predict");
    const fileInput = document.getElementById("file");
    const out = document.getElementById("out");
    const suggestionBox = document.getElementById("suggestion");
    const apiInput = document.getElementById("api");
    let apiURL = apiInput.value;

    document.getElementById("use").onclick = () => {
      apiURL = apiInput.value.trim();
      alert("Using API: " + apiURL);
    };

    const BIN_MAP = {
      "paper_cardboard": "üü¶ Blue bin (Papier)",
      "lvp_plastic_metal": "üü® Yellow bin (Gelber Sack/Tonne)",
      "glass_white": "‚ö™ White glass container",
      "glass_brown": "üü§ Brown glass container",
      "glass_green": "üü¢ Green glass container",
      "residual": "‚ö´ Restm√ºll",
      "battery": "üîã Sonderm√ºll (Hazardous waste)"
    };

    btn.onclick = async () => {
      const file = fileInput.files[0];
      if (!file) return alert("Please select an image first.");

      out.textContent = "Uploading and predicting...";
      suggestionBox.style.display = "none";

      const form = new FormData();
      form.append("file", file);

      try {
        const res = await fetch(`${apiURL}/predict`, { method: "POST", body: form });
        const json = await res.json();
        out.textContent = JSON.stringify(json, null, 2);

        if (json.ok && json.detections.length > 0) {
          const top = json.detections[0];
          const bin = BIN_MAP[top.class] || "Unknown category";
          suggestionBox.innerHTML = `<b>Detected:</b> ${top.class} ‚Üí ${bin}`;
          suggestionBox.style.display = "block";
        } else {
          suggestionBox.textContent = "No detections.";
          suggestionBox.style.display = "block";
        }
      } catch (e) {
        out.textContent = "Error: " + e;
      }
    };
  </script>
</body>
</html>
